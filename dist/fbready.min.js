/*!
 * FBReady
 * -------
 * Prepare all stuffs for using Facebook JavaScript SDK
 * 
 * @version 0.9.0
 * @author mach3 <http://github.com/mach3>
 * @url http://github.com/mach3/fbready
 * @license MIT License
 */
!function(a){var b=function(a){var b=this;this.appId=a,this.status={},this.callbacks={},this._each(this.events,function(a){b.status[a]=!1,b.callbacks[a]=[]}),this._prepare()};!function(){var c=b.prototype;c.events=["ready","login"],c.EVENT_READY="ready",c.EVENT_LOGIN="login",c.sdkUrl="//connect.facebook.net/ja_JP/all.js",c.appId=null,c.status=null,c.callbacks=null,c._prepare=function(){var b;this._has(a,"FB")?this._initApp():(this._get("fb-root")||this._append(this._create("div",{id:"fb-root"})),b=this._create("script",{src:location.protocol+this.sdkUrl}),this._onScriptReady(b,this._initApp,this),this._append(b))},c._initApp=function(){var a=this;FB.Event.subscribe("auth.statusChange",function(b){"connected"===b.status&&a.fire(a.EVENT_LOGIN)}),FB.init({appId:this.appId}),this.fire(this.EVENT_READY)},c.on=function(a,b){return this._has(this.callbacks,a)?(this.callbacks[a].push(b),this._getStatus(a)&&b(),this):void 0},c.fire=function(a){var b=this;if(this._has(this.callbacks,a))return this._each(this.callbacks[a],function(c){c({target:b,type:a})}),this._setStatus(a,!0),this},c._setStatus=function(a,b){this.status[a]=!!b},c._getStatus=function(a){return!!this.status[a]},c.render=function(){this.on("ready",function(){FB.XFBML.parse()})},c._has=function(a,b){return a.hasOwnProperty(b)},c._get=function(a){return document.getElementById(a)},c._each=function(a,b){var c;for(c in a)if(this._has(a,c)&&!1===b(a[c],c,a))break},c._create=function(a,b){var c=document.createElement(a);return this._each(b,function(a,b){c.setAttribute(b,a)}),c},c._append=function(){this._each(arguments,function(a){document.getElementsByTagName("body")[0].appendChild(a)})},c._onScriptReady=function(a,b,c){var d,e;d=!1,c=c||null,e=function(){d||(b.call(c),d=!0)},a.onload=e,a.onreadystatechange=function(){("loaded"===this.readyState||"complete"===this.readyState)&&e()}}}(),a.FBReady=b}(this);